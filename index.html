<!doctype html><html lang="de"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>VNB-Karte (Basis)</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<style>html,body,#map{height:100%;margin:0}</style>
</head><body>
<div id="map"></div>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/topojson-client@3"></script>
<script>
const URL_TOPO='data/geo_plz_min.topo.json';
const URL_CORE='data/vnb_core_map.json';

const map=L.map('map',{minZoom:5,maxZoom:12}).setView([51.2,10.4],6);
L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'Â© OSM'}).addTo(map);

// einfache farbe pro VNB (hash)
function colorFor(s){let h=0;for(let i=0;i<s.length;i++)h=(h*31+s.charCodeAt(i))>>>0;return `hsl(${h%360} 60% 60%)`;}

(async()=>{
  const [topoRes,coreRes]=await Promise.all([fetch(URL_TOPO),fetch(URL_CORE)]);
  const topo=await topoRes.json();
  const core=await coreRes.json(); // {id: "VNB-Name"}

  const obj=topo.objects[Object.keys(topo.objects)[0]];
  const geo=topojson.feature(topo,obj);

  const layer=L.geoJSON(geo,{
    style:f=>{
      const id=f.id||f.properties?.id||'';
      const name=core[id]||'unbekannt';
      return {color:'#000',weight:.25,fillOpacity:.85,fillColor:colorFor(name)};
    },
    onEachFeature:(f,l)=>{
      const id=f.id||f.properties?.id||'';
      const name=core[id]||'unbekannt';
      l.bindPopup(`VNB: <b>${name}</b>`);
      l.on('mouseover',e=>e.target.setStyle({weight:.8}));
      l.on('mouseout',e=>e.target.setStyle({weight:.25}));
    }
  }).addTo(map);

  map.fitBounds(layer.getBounds(),{padding:[20,20]});
})();
</script>
</body></html>
