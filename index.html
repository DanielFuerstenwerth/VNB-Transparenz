<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VNB-Polygone</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <style>
    html,body,#map{height:100%;margin:0;background:#f6f6f6}
    .leaflet-container{background:#f6f6f6}
  </style>
</head>
<body>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/topojson-client@3"></script>
<script>
const map = L.map('map').setView([51.2,10.4], 6); // keine Basemap

const keyOf = f => {
  const p=f.properties||{};
  return (f.id ?? p.id ?? p.vnb ?? p.VNB ?? p.name ?? p.Name ?? '').toString().trim();
};

Promise.all([
  fetch('Polygone.json').then(r=>r.json()),
  fetch('farben.json').then(r=>r.json())
]).then(([topo,farben])=>{
  const obj = Object.keys(topo.objects)[0];
  const gj  = topojson.feature(topo, topo.objects[obj]); // direkt als GeoJSON

  const style = f=>{
    const v = farben[keyOf(f)];
    return {
      color:'#444', weight:1, fillOpacity:.45,
      fillColor: v===undefined ? '#cccccc' : (String(v)=='1' ? '#2ecc71' : '#e74c3c')
    };
  };
  const each = (f,l)=> l.bindTooltip(keyOf(f)||'ohne ID',{sticky:true});

  const layer = L.geoJSON(gj,{style,onEachFeature:each}).addTo(map);
  map.fitBounds(layer.getBounds(),{padding:[8,8]});
}).catch(e=>{console.error(e); alert('Ladefehler');});
</script>
</body>
</html>
